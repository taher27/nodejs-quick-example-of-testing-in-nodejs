// ********RoostGPT********
/*
Test generated by RoostGPT for test testM using AI Type Open AI and AI Model gpt-4

ROOST_METHOD_HASH=fetchWeather_e15d09d035
ROOST_METHOD_SIG_HASH=fetchWeather_2ec6f97b3f


*/

// ********RoostGPT********
const expect = require('chai').expect;
const nock = require('nock');
const fetchWeather = require('./fetch-weather');

describe('Fetch Weather', () => {
    beforeEach(() => {
        nock('http://api.openweathermap.org')
        .get('/data/2.5/weather')
        .query({q: 'London', appid: 'aa0f1b0be45dca476178787f941c76dc'})
        .reply(200, { 
            location: 'London',
            temperature: '15°C'
        });
    });

    it('Fetches weather correctly', (done) => {
        fetchWeather('London', (data) => {
            expect(data).to.eql({ location: 'London', temperature: '15°C' });
            done();
        });
    });

    it('Handles error', (done) => {
        nock('http://api.openweathermap.org')
        .get('/data/2.5/weather')
        .query({q: 'Unknown', appid: 'aa0f1b0be45dca476178787f941c76dc'})
        .replyWithError('not found');

        fetchWeather('Unknown', (err) => {
            expect(err).to.eql('not found');
            done();
        });
    });
});
